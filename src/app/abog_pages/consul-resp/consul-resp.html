<div class="nav-actions">
  <button class="btn-back" (click)="goBack()">
    â† Volver al Foro
  </button>
</div>

<div *ngIf="isLoading" class="loading-state">
  <div class="spinner"></div>
  <p>Cargando consulta...</p>
</div>

<div *ngIf="!isLoading && errorMensaje" class="error-state">
  <p>{{ errorMensaje }}</p>
  <button class="btn-back" (click)="goBack()">Regresar</button>
</div>

<main class="respuesta-main" *ngIf="!isLoading && consulta">
  
  <section class="consulta-original">
    <div class="consulta-header">
      <div class="user-meta">
        <span class="user-icon">ğŸ‘¤</span>
        <span class="user-name">Usuario AnÃ³nimo</span>
        <span class="meta-date">{{ formatTime(consulta.fechaPublicacion) }}</span>
        <span class="materia-tag">{{ getMateria() }}</span>
      </div>
      
      <button class="btn-reportar" (click)="abrirModalReporte()" title="Reportar esta consulta">
        ğŸš© Reportar
      </button>
    </div>
    
    <div class="consulta-body">
      <h2>{{ consulta.titulo }}</h2>
      <p>{{ consulta.pregunta }}</p>
    </div>
  </section>

  <section class="nueva-respuesta-section">
    <h3>Tu Respuesta Profesional</h3>
    <div class="form-respuesta">
      <textarea 
        [(ngModel)]="nuevaRespuesta" 
        placeholder="Escribe tu asesorÃ­a legal aquÃ­. SÃ© claro y profesional..."
        rows="5"
        [disabled]="enviandoRespuesta">
      </textarea>
      
      <div class="form-actions">
        <span class="error-text" *ngIf="errorRespuesta">{{ errorRespuesta }}</span>
        <button 
          class="btn-enviar" 
          (click)="enviarRespuesta()"
          [disabled]="enviandoRespuesta || !nuevaRespuesta.trim()">
          {{ enviandoRespuesta ? 'Enviando...' : 'Enviar Respuesta' }}
        </button>
      </div>
    </div>
  </section>

  <section class="respuestas-lista">
    <h3>Respuestas de Colegas ({{ respuestas.length }})</h3>
    
    <div *ngIf="respuestas.length === 0" class="no-respuestas">
      <p>AÃºn no hay respuestas. Â¡SÃ© el primero en responder!</p>
    </div>

    <div class="card-wrapper" *ngFor="let resp of respuestas">
      <div class="respuesta-card" [class.mi-respuesta]="isMiRespuesta(resp)">
        <div class="abogado-info">
          <div class="abogado-avatar">
            {{ getNombreAbogado(resp).charAt(0) }}
          </div>
          <div class="abogado-meta">
            <span class="abogado-name">
              {{ getNombreAbogado(resp) }}
              <span *ngIf="isMiRespuesta(resp)" class="badge-tuyo">(TÃº)</span>
            </span>
            <span class="resp-date">{{ formatTime(resp.fechaRespuesta) }}</span>
          </div>
        </div>
        <div class="respuesta-content">
          <p>{{ resp.respuesta }}</p>
        </div>
        
      </div>
    </div>
  </section>

</main>

<div class="modal-overlay" *ngIf="isReportModalVisible" (click)="cerrarModalReporte()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Reportar Consulta</h3>
      <button class="btn-close" (click)="cerrarModalReporte()">&times;</button>
    </div>
    
    <div class="modal-body">
      <p>Â¿Por quÃ© deseas reportar esta consulta?</p>
      
      <div class="radio-group">
        <label *ngFor="let motivo of motivosReporte">
          <input 
            type="radio" 
            name="motivo" 
            [value]="motivo.id" 
            [(ngModel)]="motivoReporteId">
          {{ motivo.descripcion }}
        </label>
      </div>

      <div class="form-group">
        <label>Comentarios adicionales (opcional):</label>
        <textarea 
          class="custom-reason"
          [(ngModel)]="comentariosReporte"
          placeholder="Describe el motivo con mÃ¡s detalle..."
          rows="3">
        </textarea>
      </div>

      <div class="error-text" *ngIf="errorReporte">{{ errorReporte }}</div>
    </div>

    <div class="modal-footer">
      <button class="btn-cancel" (click)="cerrarModalReporte()">Cancelar</button>
      <button 
        class="btn-submit-report" 
        (click)="enviarReporte()"
        [disabled]="enviandoReporte || !motivoReporteId">
        {{ enviandoReporte ? 'Enviando...' : 'Enviar Reporte' }}
      </button>
    </div>
  </div>
</div>